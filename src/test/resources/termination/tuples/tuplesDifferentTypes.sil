import "../decreaseOrder/int_decreases.vpr"
import "../decreaseOrder/set_decreases.vpr"
import "../decreaseOrder/perm_decreases.vpr"
import "../decreaseOrder/ref_decreases.vpr"
import "../decreaseOrder/bool_decreases.vpr"
import "../decreaseOrder/multiSet_decreases.vpr"
import "../decreaseOrder/seq_decreases.vpr"
import "../decreaseOrder/pred_decreases.vpr"

function f(i:Int, s: Set[Int], p:Perm, r:Ref): Bool
requires i>=0
requires p>=none
decreases p,i,r,s
{
    r == null ? true : g(s,null,p)
}

function g(s: Set[Int], r:Ref, p:Perm): Bool
requires p>=none
decreases r,p,s
{
    p > write ? f(|s|,s,p-write,r) : false
}

function h(b:Bool, m: Multiset[Int], s: Seq[Ref]): Int
requires p(b)
decreases m,s,p(b),b
{
    unfolding p(b) in b ? h(!b, m, s) : 1
}

predicate p(b:Bool)
{
    b ==> p(!b)
}